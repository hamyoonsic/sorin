닷컴 차트핵심 = 웹소켓
mvc방식 기본  = 리퀘스트 요청부터 해석해서 response까찌 한 사이클

--

스프링에서 웹소켓 사용하기

양방향통신

일반소켓 / 웹소켓 

가장큰 특징 
데이터는 ‘패킷(packet)’ 형태로 전달되며, 전송은 커넥션 중단과 추가 HTTP 요청 없이 양방향으로 이뤄짐.

http/ https
(ws / wss)
4가지 이벤트

wep소켓이 없던 때에는 폴링을 사용했다

클라이언트가 1초 or 10초 등 주기적으로 신호를 보내고
서버답이 없으면 빈 응답이 오는것
클라이언트가 만약 10초마다 계속 서버에 요청을 던진다
클라이언트가 많아지면 서버부담

폴링 업그레이드 -> 롱폴링
주기적요청이 아니라 한번보낼때 서버 응답이 있을떄만 response던지기
즉 응답올떄까지 계속 대기)
---

멀티플렉싱
sse 서버가 클라이언트쪾으로만 사용가능 + html .css js 한번에 다 보내기(과거에는 하나씩보냄)

차트띄우는건 단방향에 가깝다
일반적으로 받는 것이니 그래서 차트도 sse로 가능

--
어노테이션 위주
스프링에서 제공하는 어노테이션이 아니라 웹소켓에서 제공
import하는 부분보면 확인가능

핸드세이킹 후 연결성공시 onopen메서드호출


자바컬렉션 Set / List / Map / Queue
Set 순서 상관없이 보관
객체
List는 순서 상관있음

컬렉션은 인터페이스
Set 구현해놓은 객체가 바로 HashSet (특징은 속도가 빠르다)

--
웹 프로그램이 어려운 이유는 하나의 스레드가 아니기 때문



ws 웹소켓은 자바오브젝트 그래서 리턴할때는 json.stringify로 변환해서 던져주기

ws 커넥션이 맺어진다


--

차트받아오기

1. ws 핸드쉐이킹? 해서 웹소켓연결
2. 시간당 주기로 돌면서 차트에 필요한 값을 가져오는 방법 (!)
2. 차트를 감시하고 있다가 변화가 있으면 변화가 있는 애들은 json하나 만들어서 보내는 방법은 동일 onmessage호출해서 (!)
for문을 돌면서 하나하나 정보를 보내주기

--

### websocket으로 만든 패키지 = socket.io
연결된 모든 클라이언트에 한번에 정보전달 (브로드캐스트)
웹소켓은 Set 리스트 포문을 돌려서 한사람한사람 메세지를 보냈음 (즉 소켓io사용하면 ㅎfor문 안돌려도댐)

노드js npm에서 socket.io가져와서 사용하면 될듯
단점 비용 자원 boilerplate코드 (쓸데없는 긴 코드)
--


### 일할때 수정이나 업그레이드 요청이 들어오면 (왜 이런 요청이 나왔는지 빠르게 파악하는게 중요)

소켓 웹소켓 폴링 소켓io 등 장단점 알아두면 이런 일처리가 빨라짐

----------

webRTC (화상회의 기반기술)


웹소켓은 tcp위에 올라가있다
tcp프로토콜 기반의 기술임 웹소켓

tcp, udp기반 차이 (webRTC의 그래프 그림 참조)


tcp = 패킷들의 중간 유실을 신경씀 (신뢰도 높음) 대신 느림
udp = 패킷 잃어버리는거 신경안씀 받는 것만 처리한다 (신뢰도 낮음) 빼름

Peer to Peer 브라우저간 직접 통신

